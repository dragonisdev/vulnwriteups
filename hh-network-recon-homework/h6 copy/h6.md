# H6

## a. Wifi Challenge lab 2.1
This is a virtual machine that simulates a wireless access point which you need to attack. Basically you are hosting a simulated wireless local area network on your laptop and you need to use Kali to scan and attack it.

### Installation
In the installation I already ran into issues because the walkthrough did not include installation guide, and I ran into an issue where Virtual Box gave me an error because of an Audio Adapter.

First we download the OVA file from the proton folder: https://drive.proton.me/urls/Q4WPB23W7R#Qk4nxMH8Q4oQ

I had a bunch of issues with the downloaded VM file because my laptop simply didn't have space and didn't have the latest virtual box version. Make sure you get both or you might have weird AudioAdapter issues which are distractions for lack of storage space.

### 00. Root flag content

The VM itself is containerized laboratory with a simulated wifi environment that simulates WEP, WPA2 and WPA3 access points inside the VM itself.

In the first challenge, we simply get the flag file from the root with `cat /root/flag`

<img src='1.png' alt='img'/>

## 01. Channel for global access point
This task asks us to find the global access point called "wifi-global"

We will use airmon-ng to sniff and intercept any packets. Note that you must do this in reality with a wifi dongle that supports monitor mode, otherwise you won't be able to do this. However, in this simulated environment we have the dongle already.

`sudo airmon-ng start wlan0` to start airmon-ng

`sudo airodump-ng wlan0mon -w ~/wifi/scan --manufacturer --wps --band abg` to start scanning for all nearby wifi networks and output it in .cap files along with vendor, WPS and all bands from 2.4Ghz to 5Ghz.

We can find a list of wifi endpoints and find our wifi-global ESSID

<img src='2.png' alt='img'/>

The CH is the channel and it shows 44 which is 5Ghz channel according to Antaira.

## 02. What is the MAC of the wifi-IT client? 

Now we need to find the MAC address of "wifi-IT" 

We already see it from our previous scan that it is channel 11 and now we need to find its MAC address.

We will use `sudo airodump-ng wlan0mon -w ~/wifi/scanc11 --manufacturer --wps -c11` to scan channel 11 specifically and listen to it.

<img src='3.png' alt='img'/>
We can see the connected devices here

The station refers to the MAC address of the device and in this case we see it's most likely `10:F9:6F:AC:53:52` that we are interested in which is the access point MAC.

Not associated means the device is not connected to anything.

Probes mean that it's looking for networks it has connected to in the past, for example home-WiFi and WiFi-Restaurant are networks the device has connected to in the past


### 03. What is the probe of 78:C1:A7:BF:72:46

In this task we want to find what probes does the MAC address `78:C1:A7:BF:72:46` send out. We will use:

`sudo airodump-ng wlan0mon -w scan --manufacturer --wps --band abg` which will show all the networks and nearby devices over wifi.

The probes that our target MAC is sending is wifi-offices, Jason. It is currently not connected to any networks.

### 04. What is the ESSID of the hidden AP (mac F0:9F:C2:6A:88:26)

In this exercise we are supposed to find out the ESSID of the hidden access point on the scan. According to the walkthrough, we will bruteforce the ESSID with rockyou.txt.

<img src='5.png' alt='img'/>

First we will download the worldlist if we don't have it: https://weakpass.com/wordlists/rockyou.txt

`gunzip rockyou.txt.gz`

We will pre-pend "wifi" before every wordlist word
`cat ~/rockyou.txt | awk '{print "wifi-" $1}' > ~/wifi-rockyou.txt`

Now we can bruteforce using mdk4 to launch probes until the access point responds

`airmon-ng start wlan0`

`iwconfig wlan0mon channel 11` because the AP is on channel 11

`mdk4 wlan0mon p -t F0:9F:C2:6A:88:26 -f ~/wifi-rockyou.txt`

Unfortunately my virtual machine decided to bug out but basically it would show the correct ESSID once you have sent the correct probe.

## b. Report

In this exercise, we learned airmon-ng and airodump-ng and learned to understand what they do and how to use them to find targets as well as information of nearby wifi devices.

We can also see which devices have accessed which networks before because they are sending probes.


## c. What are my thoughts

It is very scary to think how much information we can get with a simple monitoring mode dongle on public wifis. I understand the risk of connecting to public wifis especially with ARP-spoofing and MITM attacks which can work if the target is not paying attention.

How do I protect myself from this? By using a VPN and praying.


## References

Terokarvinen: https://terokarvinen.com/verkkoon-tunkeutuminen-ja-tiedustelu/

Wifi-challenge lab walkthrough: https://r4ulcl.com/posts/walkthrough-wifichallenge-lab-2.0/

Antaira: https://www.antaira.com/Blog_Difference-Between-2.4GHz-and-5GHz-Wireless