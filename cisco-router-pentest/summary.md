## Explicit Permission Granted by Harto Holmstr√∂m to test their Cisco Router-Switch system

# Security Audit of Cisco Router-Switch System

## x. 

I know from physical access that there are 2 routers and 3 switches on this network. I also have the SSH access to normal user on these switches. They all run Cisco OS and I am simply looking for vulnerabilities.

<img src="0.png" alt="img"/>

The router model is `C1900 Integrated Services Router` from Cisco 1941 series

The OS version is `15.5(3)M5`

Image type: `universalk9`

##### Note 

This version is rather old (last update in 2019) and not up to date and potentially vulnerable. 

## a. Scanning

I am on the same host network as the Cisco router on subnet 172.28.x.x

My Kali Linux is on bridged adapter on the same subnet. 
I began by conducting an nmap scan on the target device using `nmap -A -Pn -T4 -vv -p- <target>`

<img src="1.png" alt="img"/>

The only open port was SSH on port 22. After feeding the image to ChatGPT 5.0 for deciphering, some details from the image include `1024 bit RSA`, `OS: IOS`, `IOS 12.4-15.x version`, `Vendor: Cisco Systems, Inc.`

But we already know this is a genuine Cisco device of model 1900 series and is running version 15.5(3).

I tried again using `sudo nmap -sS -p- -T4 --reason --max-retries 2 <target>` just to make sure I got all tcp ports along with sudo command.

<img src="2.png" alt="img"/>

This time it showed a lot more ports but they were mostly filtered.

I tried one more nmap with UDP ports `sudo nmap -sU --top-ports 200 --reason --max-retries 2 <target>`

<img src="3.png" alt="img"/>

Now there's more ports open, although I cannot be sure they mean anything yet.

Right now the main ports that are open are port: `22 ssh`, `123 ntp`, `161 snmp`

I began by looking at CVEs on the internet for Cisco routers and stumbled upon one regarding the 161 snmp port: https://www.cvedetails.com/cve/CVE-2017-6743/ 

This one is a buffer overflow vulnerability for remote code execution. I first must confirm that the snmp port works.`snmpwalk -v2c -c public 172.28.200.2 1.3.6.1.2.1.1.5.0` shows if SNMP v2 works and if this returns a public string, which it does: `iso.3.6.1.2.1.1.5.0 = STRING: "Lab-R2.tielab.haaga-helia.fi"` it will open up an attack vector.

<img src="4.png" alt="img"/>

## b. Exploitation

Now that we know it is potentially vulnerable to snmp exploits, we will do some confirmation with Metasploit.

`use auxiliary/scanner/snmp/snmp_login` will help me confirm my suspicion that it is vulnerable if it completes.

<img src="5.png" alt="img"/>

It has successfully completed and It says `LOGIN SUCCESSFUL public access level read-only` and validated the community string. This system is now very highly likely vulnerable.

I have not found any valid exploit for it so the security threat is low.




## c.